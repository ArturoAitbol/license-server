<div class="new-plan-form pull-left">
  <div class="container">
    <div class="header">
      <label class="title">Create New Test Plan</label>
      <button type="button" class="close close-btn" aria-label="Close" (click)="cancel(saveModal)">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <br>
    <form (keydown.enter)="$event.preventDefault()" #planForm="ngForm">
      <div class="body" style="overflow-y: scroll;overflow-x: hidden;height: 48vh;">
        <div class="mycontainer">
          <div class="form-group">
            <label for="planName" class="form-label">Test Plan Name</label>
            <!-- <input required minlength="1" pattern="^[A-Za-z0-9 _]*[A-Za-z0-9][A-Za-z0-9 _]*$" type="text" -->
            <input required minlength="1" pattern="^(?!.*\/).*$" type="text" name="planName" placeholder="Enter Name"
              class="form-control" [(ngModel)]="testPlan.name" #planName="ngModel">
            <div *ngIf="planName.invalid && (planName.dirty || planName.touched)">
              <div *ngIf="planName?.errors?.pattern">
                <label class="invalid-message">Test Plan Name doesn't accepts slash "/"</label>
              </div>
            </div>
          </div>
          <div class="form-group">
            <label for="description" class="form-label">Description</label>
            <textarea rows="2" placeholder="What does this test plan do?" name="description" class="form-control"
              [(ngModel)]="testPlan.description" #planDesc="ngModel"></textarea>
          </div>
        </div>
        <hr>
        <div class="form-group" *ngIf="created">
          <label for="testCases" class="form-label">Test Cases: <label class="item-modified">Drag and drop from the left
              into this panel to add them to the Test Plan</label></label>
          <div cdkDropList id="list2" [cdkDropListData]="testPlan.testsList" [cdkDropListConnectedTo]="allDropLists"
            class="tests-panel" (cdkDropListDropped)="drop($event)" name="testCases">
            <div class="list-item" *ngFor="let item of testPlan.testsList" cdkDrag [cdkDragData]="item"
              (cdkDragDropped)="dragDropped($event)">
              <div class="cases-plans">
                <span class="item-name">
                  {{item.name}}
                </span>
              </div>
              <div class="cases-plans">
                <span class="item-description">
                  {{item.description}}
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="footer" *ngIf="!created">
        <button class="create-btn" (click)="save()" style="float: right;" [disabled]="!planForm.form.valid">
          Create
        </button>
        <button class="cancel-btn" (click)="cancel(saveModal)">
          Cancel
        </button>
      </div>
      <div class="footer" *ngIf="created">
        <button class="create-btn" (click)="storeTestPlan()">
          Save
        </button>
      </div>

    </form>
    <ng-template #saveModal>
      <div class="modal-header" draggableModal>

        <label class="modal-title pull-left"> Unsaved Changes</label>
        <button type="button" class="close pull-right " aria-label="Close" (click)="closeSaveModal()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-lg-12">
            <label class="form-label">
              {{'You have unsaved changes! If you leave, your changes will be lost. Do you want to proceed ?'}}
            </label>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="cancel-btn" (click)="saveTestCasesOrPlans()">
          No
        </button>
        <button class="create-btn" (click)="discardChanges()">
          Yes
        </button>
      </div>
    </ng-template>
  </div>
</div>